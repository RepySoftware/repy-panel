(self.webpackChunkrepy_panel=self.webpackChunkrepy_panel||[]).push([[850],{3310:function(e,t,n){"use strict";n.d(t,{Yi:function(){return i},Sh:function(){return o}});var i=(()=>(function(e){e.GAS_LEVEL="GAS_LEVEL"}(i||(i={})),i))();const r={[i.GAS_LEVEL]:"Medidor do n\xedvel do g\xe1s"};function o(e){return r[e]}},7850:function(e,t,n){"use strict";n.r(t),n.d(t,{DevicesModule:function(){return j}});var i=n(38583),r=n(6591),o=n(37716),s=n(38555),c=n(84465),a=n(34811);let l=(()=>{class e{constructor(e,t,n){this._loader=e,this._toast=t,this._deviceService=n,this.devices=[]}refreshDevices(e={}){return e.showLoader&&this._loader.show(),new Promise((t,n)=>{this._deviceService.getDefault().subscribe(n=>{e.showLoader&&this._loader.dismiss(),this.devices=n,this.devices.sort((e,t)=>{var n,i;return(null===(n=e.deviceGasLevel)||void 0===n?void 0:n.percentage)-(null===(i=t.deviceGasLevel)||void 0===i?void 0:i.percentage)}),t(n)},t=>{e.showLoader&&this._loader.dismiss(),this._toast.showHttpError(t),n(t)})})}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](s.D),o["\u0275\u0275inject"](c.k),o["\u0275\u0275inject"](a.U))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var d=n(54655),p=n(3310),v=n(26026),m=n(51095),u=n(93738),f=(()=>(function(e){e.SAFE="SAFE",e.WARNING="WARNING",e.DANGER="DANGER"}(f||(f={})),f))();const h={[f.SAFE]:"green",[f.WARNING]:"orange",[f.DANGER]:"red"};function g(e){return h[e]}var y=n(18007);let w=(()=>{class e{constructor(){}ngOnInit(){}getStatusColor(){return g(this.device.deviceGasLevel.status)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-list-device-gas-level"]],inputs:{device:"device"},decls:3,vars:6,template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"h3"),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"round"),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275styleProp"]("color",t.getStatusColor()),o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind2"](2,3,t.device.deviceGasLevel.percentage,2),"%\n"))},pipes:[y.L],styles:[""]}),e})();function S(e,t){if(1&e&&o["\u0275\u0275element"](0,"app-list-device-gas-level",8),2&e){const e=o["\u0275\u0275nextContext"]().$implicit;o["\u0275\u0275property"]("device",e)}}function I(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"div",5),o["\u0275\u0275elementStart"](1,"a",6),o["\u0275\u0275elementStart"](2,"mat-card"),o["\u0275\u0275elementStart"](3,"mat-card-content"),o["\u0275\u0275elementStart"](4,"mat-card-title"),o["\u0275\u0275text"](5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"mat-card-subtitle"),o["\u0275\u0275text"](7),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](8,S,1,1,"app-list-device-gas-level",7),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](1),o["\u0275\u0275propertyInterpolate1"]("routerLink","/devices/",e.id,"/details"),o["\u0275\u0275advance"](4),o["\u0275\u0275textInterpolate"](e.name),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](n.getDeviceTypeLabel(e)),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","GAS_LEVEL"==e.type)}}let E=(()=>{class e{constructor(e,t){this.devicesViewService=e,this._title=t}ngOnInit(){this._title.set("Dispositivos - Lista"),this.devicesViewService.refreshDevices({showLoader:!0})}getDeviceTypeLabel(e){return(0,p.Sh)(e.type)}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](l),o["\u0275\u0275directiveInject"](v.y))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices-list"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-12"],["mat-raised-button","","color","primary","routerLink","/devices/map"],[1,"row",2,"margin-top","10px !important"],["class","col-md-3 device",4,"ngFor","ngForOf"],[1,"col-md-3","device"],[2,"text-decoration","none",3,"routerLink"],[3,"device",4,"ngIf"],[3,"device"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"div",0),o["\u0275\u0275elementStart"](1,"div",1),o["\u0275\u0275elementStart"](2,"h1"),o["\u0275\u0275text"](3,"Dispositivos"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](4,"div",0),o["\u0275\u0275elementStart"](5,"div",1),o["\u0275\u0275elementStart"](6,"button",2),o["\u0275\u0275text"](7,"Ver mapa"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](8,"div",3),o["\u0275\u0275template"](9,I,9,4,"div",4),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](9),o["\u0275\u0275property"]("ngForOf",t.devicesViewService.devices))},directives:[m.lW,d.rH,i.sg,d.yS,u.a8,u.dn,u.n5,u.$j,i.O5,w],styles:[".device[_ngcontent-%COMP%]{margin-bottom:16px}"]}),e})();var L=n(99010);let _=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-device-gas-level-map-info"]],inputs:{device:"device"},decls:4,vars:2,template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"strong"),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](2,"br"),o["\u0275\u0275text"](3)),2&e&&(o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate"](t.device.name),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate1"]("\n",t.device.deviceGasLevel.percentage.toFixed(0),"%"))},styles:[""]}),e})();const x=["map"];function C(e,t){if(1&e&&o["\u0275\u0275element"](0,"app-device-gas-level-map-info",7),2&e){const e=o["\u0275\u0275nextContext"]().$implicit;o["\u0275\u0275property"]("device",e.device)}}function k(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"map-marker",3,4),o["\u0275\u0275listener"]("mapClick",function(){const t=o["\u0275\u0275restoreView"](e).index,n=o["\u0275\u0275reference"](1);return o["\u0275\u0275nextContext"]().openInfoWindow(n,t)}),o["\u0275\u0275elementStart"](2,"map-info-window",null,5),o["\u0275\u0275template"](4,C,1,1,"app-device-gas-level-map-info",6),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;o["\u0275\u0275property"]("position",e.marker.position)("title",e.marker.title)("label",e.marker.label)("options",e.marker.options),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngIf",e.device.deviceGasLevel)}}let D=(()=>{class e{constructor(e,t,n,i){this._loader=e,this._toast=t,this._devicesViewService=n,this._title=i,this.markers=[],this.mapZoom=12,this.mapOptions={},this._firstLoading=!0,this.refreshInterval={interval:null,time:3e3}}ngOnInit(){this._title.set("Dispositivos - Mapa")}ngAfterViewInit(){this.initDevicesData()}ngOnDestroy(){clearInterval(this.refreshInterval.interval)}initDevicesData(){this._devicesViewService.refreshDevices({showLoader:!0}).then(e=>{e.forEach(e=>{this.markers.push({device:e,marker:{position:{lat:e.address.latitude,lng:e.address.longitude},options:{icon:this.pinSymbol(g(e.deviceGasLevel.status))}}})}),this._firstLoading&&e.length&&(this.mapCenter={lat:e[0].address.latitude,lng:e[0].address.longitude},this._firstLoading=!1)})}openInfoWindow(e,t){const n=Array.from(this.infoWindowsView)[t];try{n.open({getAnchor:()=>e.getAnchor()})}catch(i){}}pinSymbol(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#444",strokeWeight:1,scale:1}}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](s.D),o["\u0275\u0275directiveInject"](c.k),o["\u0275\u0275directiveInject"](l),o["\u0275\u0275directiveInject"](v.y))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices-map"]],viewQuery:function(e,t){if(1&e&&(o["\u0275\u0275viewQuery"](x,5),o["\u0275\u0275viewQuery"](L.ch,5)),2&e){let e;o["\u0275\u0275queryRefresh"](e=o["\u0275\u0275loadQuery"]())&&(t.map=e.first),o["\u0275\u0275queryRefresh"](e=o["\u0275\u0275loadQuery"]())&&(t.infoWindowsView=e)}},decls:3,vars:4,consts:[["width","100%","height","100%",3,"zoom","center","options"],["map",""],[3,"position","title","label","options","mapClick",4,"ngFor","ngForOf"],[3,"position","title","label","options","mapClick"],["marker","mapMarker"],["infoWindow",""],[3,"device",4,"ngIf"],[3,"device"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"google-map",0,1),o["\u0275\u0275template"](2,k,5,5,"map-marker",2),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275property"]("zoom",t.mapZoom)("center",t.mapCenter)("options",t.mapOptions),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngForOf",t.markers))},directives:[L.b6,i.sg,L.O_,L.ch,i.O5,_],styles:[".btn-list[_ngcontent-%COMP%]{position:absolute;top:85px;left:20px;z-index:1}"]}),e})();const b=[{path:"",component:(()=>{class e{constructor(e,t){this.devicesViewService=e,this._title=t}ngOnInit(){this._title.set("Dispositivos"),this.devicesViewService.refreshDevices()}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](l),o["\u0275\u0275directiveInject"](v.y))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices"]],decls:1,vars:0,template:function(e,t){1&e&&o["\u0275\u0275element"](0,"router-outlet")},directives:[d.lC],styles:[""]}),e})(),children:[{path:"",pathMatch:"full",redirectTo:"list"},{path:"map",component:D},{path:"list",component:E},{path:":id/details",loadChildren:()=>Promise.all([n.e(511),n.e(592),n.e(789)]).then(n.bind(n,40789)).then(e=>e.DeviceDetailsModule)}]}];let O=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({imports:[[d.Bz.forChild(b)],d.Bz]}),e})();var A=n(35503);let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({providers:[l],imports:[[i.ez,r.h,O,A.D,L.Y4]]}),e})()},18007:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var i=n(37716);let r=(()=>{class e{transform(e,t=0){return Number(e.toFixed(t))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i["\u0275\u0275definePipe"]({name:"round",type:e,pure:!0}),e})()}}]);