(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Kbl2:function(e,t,i){"use strict";i.r(t),i.d(t,"DevicesModule",function(){return C});var n=i("ofXK"),r=i("ssao"),s=i("fXoL"),o=i("5dVO"),a=i("2g2N"),c=i("BtSu");let l=(()=>{class e{constructor(e,t,i){this._loader=e,this._toast=t,this._deviceService=i,this.devices=[]}refreshDevices(e={}){return e.showLoader&&this._loader.show(),new Promise((t,i)=>{this._deviceService.getDefault().subscribe(i=>{e.showLoader&&this._loader.dismiss(),this.devices=i,t(i)},t=>{e.showLoader&&this._loader.dismiss(),this._toast.showHttpError(t),i(t)})})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](o.a),s["\u0275\u0275inject"](a.a),s["\u0275\u0275inject"](c.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var d=i("tyNb"),p=i("K6Ak"),m=i("bTqV"),v=i("Wp6s"),f=i("KTzz");function h(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",5),s["\u0275\u0275elementStart"](1,"a",6),s["\u0275\u0275elementStart"](2,"mat-card"),s["\u0275\u0275elementStart"](3,"mat-card-content"),s["\u0275\u0275elementStart"](4,"mat-card-title"),s["\u0275\u0275text"](5),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"mat-card-subtitle"),s["\u0275\u0275text"](7),s["\u0275\u0275pipe"](8,"address"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275propertyInterpolate1"]("routerLink","/devices/",e.id,"/details"),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](e.name),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](8,3,e.address))}}let u=(()=>{class e{constructor(e,t){this.devicesViewService=e,this._title=t,this.devices=[]}ngOnInit(){this._title.set("Dispositivos - Lista"),this.devicesViewService.refreshDevices({showLoader:!0})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l),s["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices-list"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-12"],["mat-raised-button","","color","primary","routerLink","/devices/map"],[1,"row",2,"margin-top","10px !important"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"col-md-4"],[2,"text-decoration","none",3,"routerLink"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"h1"),s["\u0275\u0275text"](3,"Dispositivos"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"div",0),s["\u0275\u0275elementStart"](5,"div",1),s["\u0275\u0275elementStart"](6,"button",2),s["\u0275\u0275text"](7,"Ver mapa"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"div",3),s["\u0275\u0275template"](9,h,9,5,"div",4),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](9),s["\u0275\u0275property"]("ngForOf",t.devicesViewService.devices))},directives:[m.a,d.d,n.l,d.f,v.a,v.c,v.g,v.f],pipes:[f.a],styles:[""]}),e})();var w=i("3sZV");let g=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-device-gas-level-map-info"]],inputs:{device:"device"},decls:1,vars:1,template:function(e,t){1&e&&s["\u0275\u0275text"](0),2&e&&s["\u0275\u0275textInterpolate1"]("",t.device.deviceGasLevel.percentage.toFixed(0),"%")},styles:[""]}),e})();const y=["map"];function S(e,t){if(1&e&&s["\u0275\u0275element"](0,"app-device-gas-level-map-info",7),2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275property"]("device",e.device)}}function I(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"map-marker",3,4),s["\u0275\u0275listener"]("mapClick",function(){s["\u0275\u0275restoreView"](e);const i=t.index,n=s["\u0275\u0275reference"](1);return s["\u0275\u0275nextContext"]().openInfoWindow(n,i)}),s["\u0275\u0275elementStart"](2,"map-info-window",null,5),s["\u0275\u0275template"](4,S,1,1,"app-device-gas-level-map-info",6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275property"]("position",e.marker.position)("title",e.marker.title)("label",e.marker.label)("options",e.marker.options),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf",e.device.deviceGasLevel)}}let k=(()=>{class e{constructor(e,t,i,n){this._loader=e,this._toast=t,this._devicesViewService=i,this._title=n,this.markers=[],this.mapZoom=12,this.mapOptions={},this._firstLoading=!0,this.refreshInterval={interval:null,time:3e3}}ngOnInit(){this._title.set("Dispositivos - Mapa")}ngAfterViewInit(){this.initDevicesData()}ngOnDestroy(){clearInterval(this.refreshInterval.interval)}initDevicesData(){this._devicesViewService.refreshDevices({showLoader:!0}).then(e=>{e.forEach(e=>{this.markers.push({device:e,marker:{position:{lat:e.address.latitude,lng:e.address.longitude},title:e.name,label:{text:e.name,className:"map-marker-label"},options:{icon:this.pinSymbol("blue")}}})}),this._firstLoading&&e.length&&(this.mapCenter={lat:e[0].address.latitude,lng:e[0].address.longitude},this._firstLoading=!1)})}openInfoWindow(e,t){const i=Array.from(this.infoWindowsView)[t];try{i.open({getAnchor:()=>e.getAnchor()})}catch(n){}}pinSymbol(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#444",strokeWeight:1,scale:1}}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](a.a),s["\u0275\u0275directiveInject"](l),s["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices-map"]],viewQuery:function(e,t){if(1&e&&(s["\u0275\u0275viewQuery"](y,!0),s["\u0275\u0275viewQuery"](w.c,!0)),2&e){let e;s["\u0275\u0275queryRefresh"](e=s["\u0275\u0275loadQuery"]())&&(t.map=e.first),s["\u0275\u0275queryRefresh"](e=s["\u0275\u0275loadQuery"]())&&(t.infoWindowsView=e)}},decls:3,vars:4,consts:[["width","100%","height","100%",3,"zoom","center","options"],["map",""],[3,"position","title","label","options","mapClick",4,"ngFor","ngForOf"],[3,"position","title","label","options","mapClick"],["marker","mapMarker"],["infoWindow",""],[3,"device",4,"ngIf"],[3,"device"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"google-map",0,1),s["\u0275\u0275template"](2,I,5,5,"map-marker",2),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275property"]("zoom",t.mapZoom)("center",t.mapCenter)("options",t.mapOptions),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.markers))},directives:[w.a,n.l,w.d,w.c,n.m,g],styles:[".btn-list[_ngcontent-%COMP%]{position:absolute;top:85px;left:20px;z-index:1}"]}),e})();const b=[{path:"",component:(()=>{class e{constructor(e,t){this.devicesViewService=e,this._title=t}ngOnInit(){this._title.set("Dispositivos"),this.devicesViewService.refreshDevices()}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l),s["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-devices"]],decls:1,vars:0,template:function(e,t){1&e&&s["\u0275\u0275element"](0,"router-outlet")},directives:[d.h],styles:[""]}),e})(),children:[{path:"",pathMatch:"full",redirectTo:"list"},{path:"map",component:k},{path:"list",component:u},{path:":id/details",loadChildren:()=>i.e(14).then(i.bind(null,"zjaR")).then(e=>e.DeviceDetailsModule)}]}];let _=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[d.g.forChild(b)],d.g]}),e})();var x=i("iTUp");let C=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[l],imports:[[n.c,r.a,_,x.a,w.b]]}),e})()}}]);