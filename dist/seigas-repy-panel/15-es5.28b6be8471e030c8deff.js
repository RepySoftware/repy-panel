!function(){function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Kbl2:function(n,r,o){"use strict";var a;o.r(r),o.d(r,"DevicesModule",function(){return R});var s,c=o("ofXK"),l=o("ssao"),d=o("fXoL"),p=o("5dVO"),u=o("2g2N"),v=o("BtSu"),f=((s=function(){function e(n,i,r){t(this,e),this._loader=n,this._toast=i,this._deviceService=r,this.devices=[]}return i(e,[{key:"refreshDevices",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.showLoader&&this._loader.show(),new Promise(function(n,i){e._deviceService.getDefault().subscribe(function(i){t.showLoader&&e._loader.dismiss(),e.devices=i,n(i)},function(n){t.showLoader&&e._loader.dismiss(),e._toast.showHttpError(n),i(n)})})}}]),e}()).\u0275fac=function(e){return new(e||s)(d["\u0275\u0275inject"](p.a),d["\u0275\u0275inject"](u.a),d["\u0275\u0275inject"](v.a))},s.\u0275prov=d["\u0275\u0275defineInjectable"]({token:s,factory:s.\u0275fac}),s),m=o("tyNb"),h=o("K6Ak"),y=o("bTqV"),g=o("Wp6s"),w=o("KTzz");function k(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",5),d["\u0275\u0275elementStart"](1,"a",6),d["\u0275\u0275elementStart"](2,"mat-card"),d["\u0275\u0275elementStart"](3,"mat-card-content"),d["\u0275\u0275elementStart"](4,"mat-card-title"),d["\u0275\u0275text"](5),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](6,"mat-card-subtitle"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"address"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;d["\u0275\u0275advance"](1),d["\u0275\u0275propertyInterpolate1"]("routerLink","/devices/",n.id,"/details"),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](n.name),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](8,3,n.address))}}var S,b,I=((S=function(){function e(n,i){t(this,e),this.devicesViewService=n,this._title=i,this.devices=[]}return i(e,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos - Lista"),this.devicesViewService.refreshDevices({showLoader:!0})}}]),e}()).\u0275fac=function(e){return new(e||S)(d["\u0275\u0275directiveInject"](f),d["\u0275\u0275directiveInject"](h.a))},S.\u0275cmp=d["\u0275\u0275defineComponent"]({type:S,selectors:[["app-devices-list"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-12"],["mat-raised-button","","color","primary","routerLink","/devices/map"],[1,"row",2,"margin-top","10px !important"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"col-md-4"],[2,"text-decoration","none",3,"routerLink"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275elementStart"](1,"div",1),d["\u0275\u0275elementStart"](2,"h1"),d["\u0275\u0275text"](3,"Dispositivos"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](4,"div",0),d["\u0275\u0275elementStart"](5,"div",1),d["\u0275\u0275elementStart"](6,"button",2),d["\u0275\u0275text"](7,"Ver mapa"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](8,"div",3),d["\u0275\u0275template"](9,k,9,5,"div",4),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](9),d["\u0275\u0275property"]("ngForOf",t.devicesViewService.devices))},directives:[y.a,m.d,c.l,m.f,g.a,g.c,g.g,g.f],pipes:[w.a],styles:[""]}),S),E=o("3sZV"),_=function(e){return e.SAFE="SAFE",e.WARNING="WARNING",e.DANGER="DANGER",e}({}),x=(e(a={},_.SAFE,"green"),e(a,_.WARNING,"orange"),e(a,_.DANGER,"red"),a),D=((b=function(){function e(){t(this,e)}return i(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||b)},b.\u0275cmp=d["\u0275\u0275defineComponent"]({type:b,selectors:[["app-device-gas-level-map-info"]],inputs:{device:"device"},decls:4,vars:2,template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"strong"),d["\u0275\u0275text"](1),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](2,"br"),d["\u0275\u0275text"](3)),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate"](t.device.name),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate1"]("\n",t.device.deviceGasLevel.percentage.toFixed(0),"%"))},styles:[""]}),b),C=["map"];function j(e,t){if(1&e&&d["\u0275\u0275element"](0,"app-device-gas-level-map-info",7),2&e){var n=d["\u0275\u0275nextContext"]().$implicit;d["\u0275\u0275property"]("device",n.device)}}function O(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"map-marker",3,4),d["\u0275\u0275listener"]("mapClick",function(){d["\u0275\u0275restoreView"](n);var e=t.index,i=d["\u0275\u0275reference"](1);return d["\u0275\u0275nextContext"]().openInfoWindow(i,e)}),d["\u0275\u0275elementStart"](2,"map-info-window",null,5),d["\u0275\u0275template"](4,j,1,1,"app-device-gas-level-map-info",6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;d["\u0275\u0275property"]("position",i.marker.position)("title",i.marker.title)("label",i.marker.label)("options",i.marker.options),d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngIf",i.device.deviceGasLevel)}}var L,V,A,N,F=((L=function(){function e(n,i,r,o){t(this,e),this._loader=n,this._toast=i,this._devicesViewService=r,this._title=o,this.markers=[],this.mapZoom=12,this.mapOptions={},this._firstLoading=!0,this.refreshInterval={interval:null,time:3e3}}return i(e,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos - Mapa")}},{key:"ngAfterViewInit",value:function(){this.initDevicesData()}},{key:"ngOnDestroy",value:function(){clearInterval(this.refreshInterval.interval)}},{key:"initDevicesData",value:function(){var e=this;this._devicesViewService.refreshDevices({showLoader:!0}).then(function(t){t.forEach(function(t){var n;e.markers.push({device:t,marker:{position:{lat:t.address.latitude,lng:t.address.longitude},options:{icon:e.pinSymbol((n=t.deviceGasLevel.status,x[n]))}}})}),e._firstLoading&&t.length&&(e.mapCenter={lat:t[0].address.latitude,lng:t[0].address.longitude},e._firstLoading=!1)})}},{key:"openInfoWindow",value:function(e,t){var n=Array.from(this.infoWindowsView)[t];try{n.open({getAnchor:function(){return e.getAnchor()}})}catch(i){}}},{key:"pinSymbol",value:function(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#444",strokeWeight:1,scale:1}}}]),e}()).\u0275fac=function(e){return new(e||L)(d["\u0275\u0275directiveInject"](p.a),d["\u0275\u0275directiveInject"](u.a),d["\u0275\u0275directiveInject"](f),d["\u0275\u0275directiveInject"](h.a))},L.\u0275cmp=d["\u0275\u0275defineComponent"]({type:L,selectors:[["app-devices-map"]],viewQuery:function(e,t){var n;1&e&&(d["\u0275\u0275viewQuery"](C,!0),d["\u0275\u0275viewQuery"](E.c,!0)),2&e&&(d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.map=n.first),d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.infoWindowsView=n))},decls:3,vars:4,consts:[["width","100%","height","100%",3,"zoom","center","options"],["map",""],[3,"position","title","label","options","mapClick",4,"ngFor","ngForOf"],[3,"position","title","label","options","mapClick"],["marker","mapMarker"],["infoWindow",""],[3,"device",4,"ngIf"],[3,"device"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"google-map",0,1),d["\u0275\u0275template"](2,O,5,5,"map-marker",2),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275property"]("zoom",t.mapZoom)("center",t.mapCenter)("options",t.mapOptions),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",t.markers))},directives:[E.a,c.l,E.d,E.c,c.m,D],styles:[".btn-list[_ngcontent-%COMP%]{position:absolute;top:85px;left:20px;z-index:1}"]}),L),W=[{path:"",component:(V=function(){function e(n,i){t(this,e),this.devicesViewService=n,this._title=i}return i(e,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos"),this.devicesViewService.refreshDevices()}},{key:"ngOnDestroy",value:function(){}}]),e}(),V.\u0275fac=function(e){return new(e||V)(d["\u0275\u0275directiveInject"](f),d["\u0275\u0275directiveInject"](h.a))},V.\u0275cmp=d["\u0275\u0275defineComponent"]({type:V,selectors:[["app-devices"]],decls:1,vars:0,template:function(e,t){1&e&&d["\u0275\u0275element"](0,"router-outlet")},directives:[m.h],styles:[""]}),V),children:[{path:"",pathMatch:"full",redirectTo:"list"},{path:"map",component:F},{path:"list",component:I},{path:":id/details",loadChildren:function(){return Promise.all([o.e(0),o.e(12)]).then(o.bind(null,"zjaR")).then(function(e){return e.DeviceDetailsModule})}}]}],G=((A=function e(){t(this,e)}).\u0275mod=d["\u0275\u0275defineNgModule"]({type:A}),A.\u0275inj=d["\u0275\u0275defineInjector"]({factory:function(e){return new(e||A)},imports:[[m.g.forChild(W)],m.g]}),A),M=o("iTUp"),R=((N=function e(){t(this,e)}).\u0275mod=d["\u0275\u0275defineNgModule"]({type:N}),N.\u0275inj=d["\u0275\u0275defineInjector"]({factory:function(e){return new(e||N)},providers:[f],imports:[[c.c,l.a,G,M.a,E.b]]}),N)}}])}();