!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Kbl2:function(t,i,r){"use strict";r.r(i),r.d(i,"DevicesModule",function(){return F});var o,a=r("ofXK"),s=r("ssao"),c=r("fXoL"),l=r("5dVO"),d=r("2g2N"),p=r("BtSu"),u=((o=function(){function t(n,i,r){e(this,t),this._loader=n,this._toast=i,this._deviceService=r,this.devices=[]}return n(t,[{key:"refreshDevices",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.showLoader&&this._loader.show(),new Promise(function(n,i){e._deviceService.getDefault().subscribe(function(i){t.showLoader&&e._loader.dismiss(),e.devices=i,n(i)},function(n){t.showLoader&&e._loader.dismiss(),e._toast.showHttpError(n),i(n)})})}}]),t}()).\u0275fac=function(e){return new(e||o)(c["\u0275\u0275inject"](l.a),c["\u0275\u0275inject"](d.a),c["\u0275\u0275inject"](p.a))},o.\u0275prov=c["\u0275\u0275defineInjectable"]({token:o,factory:o.\u0275fac}),o),m=r("tyNb"),v=r("K6Ak"),f=r("bTqV"),h=r("Wp6s"),y=r("KTzz");function w(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div",5),c["\u0275\u0275elementStart"](1,"a",6),c["\u0275\u0275elementStart"](2,"mat-card"),c["\u0275\u0275elementStart"](3,"mat-card-content"),c["\u0275\u0275elementStart"](4,"mat-card-title"),c["\u0275\u0275text"](5),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"mat-card-subtitle"),c["\u0275\u0275text"](7),c["\u0275\u0275pipe"](8,"address"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275propertyInterpolate1"]("routerLink","/devices/",n.id,"/details"),c["\u0275\u0275advance"](4),c["\u0275\u0275textInterpolate"](n.name),c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](c["\u0275\u0275pipeBind1"](8,3,n.address))}}var g,k,b=((g=function(){function t(n,i){e(this,t),this.devicesViewService=n,this._title=i,this.devices=[]}return n(t,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos - Lista"),this.devicesViewService.refreshDevices({showLoader:!0})}}]),t}()).\u0275fac=function(e){return new(e||g)(c["\u0275\u0275directiveInject"](u),c["\u0275\u0275directiveInject"](v.a))},g.\u0275cmp=c["\u0275\u0275defineComponent"]({type:g,selectors:[["app-devices-list"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-12"],["mat-raised-button","","color","primary","routerLink","/devices/map"],[1,"row",2,"margin-top","10px !important"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"col-md-4"],[2,"text-decoration","none",3,"routerLink"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",0),c["\u0275\u0275elementStart"](1,"div",1),c["\u0275\u0275elementStart"](2,"h1"),c["\u0275\u0275text"](3,"Dispositivos"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](4,"div",0),c["\u0275\u0275elementStart"](5,"div",1),c["\u0275\u0275elementStart"](6,"button",2),c["\u0275\u0275text"](7,"Ver mapa"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](8,"div",3),c["\u0275\u0275template"](9,w,9,5,"div",4),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](9),c["\u0275\u0275property"]("ngForOf",t.devicesViewService.devices))},directives:[f.a,m.d,a.l,m.f,h.a,h.c,h.g,h.f],pipes:[y.a],styles:[""]}),g),S=r("3sZV"),I=((k=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(e){return new(e||k)},k.\u0275cmp=c["\u0275\u0275defineComponent"]({type:k,selectors:[["app-device-gas-level-map-info"]],inputs:{device:"device"},decls:1,vars:1,template:function(e,t){1&e&&c["\u0275\u0275text"](0),2&e&&c["\u0275\u0275textInterpolate1"]("",t.device.deviceGasLevel.percentage.toFixed(0),"%")},styles:[""]}),k),_=["map"];function x(e,t){if(1&e&&c["\u0275\u0275element"](0,"app-device-gas-level-map-info",7),2&e){var n=c["\u0275\u0275nextContext"]().$implicit;c["\u0275\u0275property"]("device",n.device)}}function C(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"map-marker",3,4),c["\u0275\u0275listener"]("mapClick",function(){c["\u0275\u0275restoreView"](n);var e=t.index,i=c["\u0275\u0275reference"](1);return c["\u0275\u0275nextContext"]().openInfoWindow(i,e)}),c["\u0275\u0275elementStart"](2,"map-info-window",null,5),c["\u0275\u0275template"](4,x,1,1,"app-device-gas-level-map-info",6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;c["\u0275\u0275property"]("position",i.marker.position)("title",i.marker.title)("label",i.marker.label)("options",i.marker.options),c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("ngIf",i.device.deviceGasLevel)}}var E,j,D,O,V=((E=function(){function t(n,i,r,o){e(this,t),this._loader=n,this._toast=i,this._devicesViewService=r,this._title=o,this.markers=[],this.mapZoom=12,this.mapOptions={},this._firstLoading=!0,this.refreshInterval={interval:null,time:3e3}}return n(t,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos - Mapa")}},{key:"ngAfterViewInit",value:function(){this.initDevicesData()}},{key:"ngOnDestroy",value:function(){clearInterval(this.refreshInterval.interval)}},{key:"initDevicesData",value:function(){var e=this;this._devicesViewService.refreshDevices({showLoader:!0}).then(function(t){t.forEach(function(t){e.markers.push({device:t,marker:{position:{lat:t.address.latitude,lng:t.address.longitude},title:t.name,label:{text:t.name,className:"map-marker-label"},options:{icon:e.pinSymbol("blue")}}})}),e._firstLoading&&t.length&&(e.mapCenter={lat:t[0].address.latitude,lng:t[0].address.longitude},e._firstLoading=!1)})}},{key:"openInfoWindow",value:function(e,t){var n=Array.from(this.infoWindowsView)[t];try{n.open({getAnchor:function(){return e.getAnchor()}})}catch(i){}}},{key:"pinSymbol",value:function(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#444",strokeWeight:1,scale:1}}}]),t}()).\u0275fac=function(e){return new(e||E)(c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](d.a),c["\u0275\u0275directiveInject"](u),c["\u0275\u0275directiveInject"](v.a))},E.\u0275cmp=c["\u0275\u0275defineComponent"]({type:E,selectors:[["app-devices-map"]],viewQuery:function(e,t){var n;1&e&&(c["\u0275\u0275viewQuery"](_,!0),c["\u0275\u0275viewQuery"](S.c,!0)),2&e&&(c["\u0275\u0275queryRefresh"](n=c["\u0275\u0275loadQuery"]())&&(t.map=n.first),c["\u0275\u0275queryRefresh"](n=c["\u0275\u0275loadQuery"]())&&(t.infoWindowsView=n))},decls:3,vars:4,consts:[["width","100%","height","100%",3,"zoom","center","options"],["map",""],[3,"position","title","label","options","mapClick",4,"ngFor","ngForOf"],[3,"position","title","label","options","mapClick"],["marker","mapMarker"],["infoWindow",""],[3,"device",4,"ngIf"],[3,"device"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"google-map",0,1),c["\u0275\u0275template"](2,C,5,5,"map-marker",2),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275property"]("zoom",t.mapZoom)("center",t.mapCenter)("options",t.mapOptions),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngForOf",t.markers))},directives:[S.a,a.l,S.d,S.c,a.m,I],styles:[".btn-list[_ngcontent-%COMP%]{position:absolute;top:85px;left:20px;z-index:1}"]}),E),L=[{path:"",component:(j=function(){function t(n,i){e(this,t),this.devicesViewService=n,this._title=i}return n(t,[{key:"ngOnInit",value:function(){this._title.set("Dispositivos"),this.devicesViewService.refreshDevices()}},{key:"ngOnDestroy",value:function(){}}]),t}(),j.\u0275fac=function(e){return new(e||j)(c["\u0275\u0275directiveInject"](u),c["\u0275\u0275directiveInject"](v.a))},j.\u0275cmp=c["\u0275\u0275defineComponent"]({type:j,selectors:[["app-devices"]],decls:1,vars:0,template:function(e,t){1&e&&c["\u0275\u0275element"](0,"router-outlet")},directives:[m.h],styles:[""]}),j),children:[{path:"",pathMatch:"full",redirectTo:"list"},{path:"map",component:V},{path:"list",component:b},{path:":id/details",loadChildren:function(){return r.e(14).then(r.bind(null,"zjaR")).then(function(e){return e.DeviceDetailsModule})}}]}],M=((D=function t(){e(this,t)}).\u0275mod=c["\u0275\u0275defineNgModule"]({type:D}),D.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||D)},imports:[[m.g.forChild(L)],m.g]}),D),z=r("iTUp"),F=((O=function t(){e(this,t)}).\u0275mod=c["\u0275\u0275defineNgModule"]({type:O}),O.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||O)},providers:[u],imports:[[a.c,s.a,M,z.a,S.b]]}),O)}}])}();