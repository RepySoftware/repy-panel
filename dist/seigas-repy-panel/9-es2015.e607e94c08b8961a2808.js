(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"7itd":function(e,t,n){!function(e,t,n){"use strict";var o=function(){return function(e){e&&Object.assign(this,e)}}(),a=function(){function t(e,t){this.el=e,this.ngZone=t,this.onAddressChange=new n.EventEmitter}return t.prototype.ngAfterViewInit=function(){this.options||(this.options=new o),this.initialize()},t.prototype.isGoogleLibExists=function(){return!(!google||!google.maps||!google.maps.places)},t.prototype.initialize=function(){var e=this;if(!this.isGoogleLibExists())throw new Error("Google maps library can not be found");if(this.autocomplete=new google.maps.places.Autocomplete(this.el.nativeElement,this.options),!this.autocomplete)throw new Error("Autocomplete is not initialized");null!=!this.autocomplete.addListener&&(this.eventListener=this.autocomplete.addListener("place_changed",function(){e.handleChangeEvent()})),this.el.nativeElement.addEventListener("keydown",function(t){t.key&&"enter"==t.key.toLowerCase()&&t.target===e.el.nativeElement&&(t.preventDefault(),t.stopPropagation())}),window&&window.navigator&&window.navigator.userAgent&&navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&setTimeout(function(){var e=document.getElementsByClassName("pac-container");if(e){var t=Array.from(e);if(t)for(var n=0,o=t;n<o.length;n++){var a=o[n];a&&a.addEventListener("touchend",function(e){e.stopImmediatePropagation()})}}},500)},t.prototype.reset=function(){this.autocomplete.setComponentRestrictions(this.options.componentRestrictions),this.autocomplete.setTypes(this.options.types)},t.prototype.handleChangeEvent=function(){var e=this;this.ngZone.run(function(){e.place=e.autocomplete.getPlace(),e.place&&e.onAddressChange.emit(e.place)})},t.ctorParameters=function(){return[{type:n.ElementRef},{type:n.NgZone}]},t.propDecorators={options:[{type:n.Input,args:["options"]}],onAddressChange:[{type:n.Output}]},t.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(e.NgZone))},t.\u0275dir=e.\u0275\u0275defineDirective({type:t,selectors:[["","ngx-google-places-autocomplete",""]],inputs:{options:"options"},outputs:{onAddressChange:"onAddressChange"},exportAs:["ngx-places"]}),t}();t.GooglePlaceModule=function(){function t(){}return t.ctorParameters=function(){return[]},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=e.\u0275\u0275defineInjector({factory:function(e){return new(e||t)}}),t}(),t.GooglePlaceDirective=a,Object.defineProperty(t,"__esModule",{value:!0})}(n("fXoL"),t,n("fXoL"))},PCNd:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n("ssao"),a=n("iTUp"),r=n("ofXK"),i=n("tmjD"),s=n("3Pt+"),l=n("7itd"),c=n("fXoL");let d=(()=>{class e{}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.a,a.a,r.c,i.b,s.r,s.i,l.GooglePlaceModule],i.b]}),e})()},iTUp:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n("fXoL");let a=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)}}),e})()},sfnj:function(e,t,n){"use strict";n.r(t),n.d(t,"StockModule",function(){return Me});var o=n("ofXK"),a=n("tyNb"),r=n("3Pt+"),i=n("0IaG"),s=n("fXoL"),l=n("5dVO"),c=n("2g2N"),d=n("xqXW"),m=n("q3OW"),p=n("kmnG"),u=n("qFsG"),h=n("d3UM"),f=n("bTqV"),v=n("IpZF"),g=n("FKr1");function S(e,t){1&e&&s["\u0275\u0275element"](0,"button-dialog-close")}function y(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"h3",12),s["\u0275\u0275text"](1,"Novo dep\xf3sito"),s["\u0275\u0275elementEnd"]())}function E(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"h3",12),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("Edi\xe7\xe3o ",e.deposit.name,"")}}function b(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function I(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",13),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function w(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}let x=(()=>{class e{constructor(e,t,n,o,a,r){this._loader=e,this._toast=t,this._depositService=n,this._companyBranchService=o,this._dialogRef=a,this.inputData=r,this.companyBranches=[],this.initForm()}ngOnInit(){this.getCompanyBranches(),this.inputData.depositId&&this.getDeposit().then(()=>this.setFormValues())}initForm(){this.depositForm=new r.g({name:new r.e(null,r.s.required),companyBranch:new r.e(null,r.s.required)})}setFormValues(){this.depositForm.get("name").setValue(this.deposit.name),this.depositForm.get("companyBranch").setValue(this.deposit.companyBranch.id)}getDeposit(){return new Promise((e,t)=>{this._loader.show(),this._depositService.getById(this.inputData.depositId).subscribe(t=>{this._loader.dismiss(),this.deposit=t,e(t)},e=>{this._loader.dismiss(),this._toast.showHttpError(e),t(e)})})}getCompanyBranches(){this._companyBranchService.getAll().subscribe(e=>{this.companyBranches=e},e=>{this._toast.showHttpError(e)})}save(){if(!this.depositForm.valid)throw this.depositForm.markAllAsTouched(),this._toast.open("Preencha todos os campos obrigat\xf3rios"),new Error("Invalid form");const e={name:this.depositForm.get("name").value,companyBranchId:this.depositForm.get("companyBranch").value};let t;this.deposit?(e.id=this.deposit.id,t=this._depositService.update(e)):t=this._depositService.create(e),this._loader.show(),t.subscribe(e=>{this._loader.dismiss(),this._toast.open("Salvo com sucesso!","success"),this.deposit=e,this.initForm(),this.setFormValues(),this._dialogRef.close({hasUpdate:!0})},e=>{this._loader.dismiss(),this._toast.showHttpError(e)})}get isModal(){return!!this.inputData}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](d.a),s["\u0275\u0275directiveInject"](m.a),s["\u0275\u0275directiveInject"](i.g),s["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-deposit-form"]],decls:25,vars:7,consts:[[4,"ngIf"],[1,"row"],[1,"col-sm-12"],["class","title",4,"ngIf"],[3,"formGroup"],[1,"col-12"],["matInput","","placeholder","Nome","autocomplete","off","formControlName","name"],["name",""],["formControlName","companyBranch"],["type",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",2,"margin","24px 0",3,"click"],[1,"title"],[3,"value"]],template:function(e,t){if(1&e&&(s["\u0275\u0275template"](0,S,1,0,"button-dialog-close",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275template"](3,y,2,0,"h3",3),s["\u0275\u0275template"](4,E,2,1,"h3",3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"form",4),s["\u0275\u0275elementStart"](6,"div",1),s["\u0275\u0275elementStart"](7,"div",5),s["\u0275\u0275elementStart"](8,"mat-form-field"),s["\u0275\u0275element"](9,"input",6,7),s["\u0275\u0275template"](11,b,2,0,"mat-error",0),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"div",5),s["\u0275\u0275elementStart"](13,"mat-form-field"),s["\u0275\u0275elementStart"](14,"mat-label"),s["\u0275\u0275text"](15,"Unidade"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"mat-select",8,9),s["\u0275\u0275template"](18,I,2,2,"mat-option",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](19,w,2,0,"mat-error",0),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](20,"hr"),s["\u0275\u0275elementStart"](21,"div",1),s["\u0275\u0275elementStart"](22,"div",2),s["\u0275\u0275elementStart"](23,"button",11),s["\u0275\u0275listener"]("click",function(){return t.save()}),s["\u0275\u0275text"](24,"Salvar"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](10);s["\u0275\u0275property"]("ngIf",t.isModal),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",!t.deposit),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.deposit),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("formGroup",t.depositForm),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngIf",!e.valid),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngForOf",t.companyBranches),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.depositForm.get("companyBranch").valid)}},directives:[o.m,r.t,r.n,r.h,p.c,u.b,r.d,r.m,r.f,p.f,h.a,o.l,f.a,v.a,p.b,g.k],styles:[""]}),e})();var _=n("K6Ak"),C=n("+0xr"),k=n("NFeN");function P(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",11),s["\u0275\u0275text"](1,"#"),s["\u0275\u0275elementEnd"]())}function O(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",12),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](e.id)}}function D(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",11),s["\u0275\u0275text"](1,"Nome"),s["\u0275\u0275elementEnd"]())}function F(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",12),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function j(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",11),s["\u0275\u0275text"](1,"Unidade"),s["\u0275\u0275elementEnd"]())}function B(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",12),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.companyBranch.name," ")}}function A(e,t){1&e&&s["\u0275\u0275element"](0,"th",11)}function M(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td",12),s["\u0275\u0275elementStart"](1,"a",13),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"]().openForm(n.id)}),s["\u0275\u0275elementStart"](2,"mat-icon"),s["\u0275\u0275text"](3,"edit"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function T(e,t){1&e&&s["\u0275\u0275element"](0,"tr",14)}function q(e,t){1&e&&s["\u0275\u0275element"](0,"tr",15)}let N=(()=>{class e{constructor(e,t,n,o,a){this._loader=e,this._toast=t,this._depositService=n,this._dialog=o,this._title=a,this.deposits=[],this.tableColumns=["id","name","companyBranch","options"]}ngOnInit(){this._title.set("Dep\xf3sitos"),this.getDeposits()}getDeposits(){return new Promise((e,t)=>{this._loader.show(),this._depositService.getAll().subscribe(t=>{this._loader.dismiss(),this.deposits=t,e()},e=>{this._loader.dismiss(),this._toast.showHttpError(e),t()})})}openForm(e){this._dialog.open(x,{width:"90%",height:"90%",data:{depositId:e}}).afterClosed().subscribe(e=>{e&&e.hasUpdate&&this.getDeposits()})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](d.a),s["\u0275\u0275directiveInject"](i.b),s["\u0275\u0275directiveInject"](_.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-deposits"]],decls:20,vars:3,consts:[[2,"font-size","32px","margin","16px"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","companyBranch"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["href","javascript:;","mat-fab","","color","primary",1,"btn-add",3,"click"],["mat-header-cell",""],["mat-cell",""],["href","javascript:;",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"h1",0),s["\u0275\u0275text"](1,"Dep\xf3sitos"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](2,"table",1),s["\u0275\u0275elementContainerStart"](3,2),s["\u0275\u0275template"](4,P,2,0,"th",3),s["\u0275\u0275template"](5,O,2,1,"td",4),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](6,5),s["\u0275\u0275template"](7,D,2,0,"th",3),s["\u0275\u0275template"](8,F,2,1,"td",4),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](9,6),s["\u0275\u0275template"](10,j,2,0,"th",3),s["\u0275\u0275template"](11,B,2,1,"td",4),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](12,7),s["\u0275\u0275template"](13,A,1,0,"th",3),s["\u0275\u0275template"](14,M,4,0,"td",4),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275template"](15,T,1,0,"tr",8),s["\u0275\u0275template"](16,q,1,0,"tr",9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](17,"button",10),s["\u0275\u0275listener"]("click",function(){return t.openForm()}),s["\u0275\u0275elementStart"](18,"mat-icon"),s["\u0275\u0275text"](19,"add"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("dataSource",t.deposits),s["\u0275\u0275advance"](13),s["\u0275\u0275property"]("matHeaderRowDef",t.tableColumns),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("matRowDefColumns",t.tableColumns))},directives:[C.j,C.c,C.e,C.b,C.g,C.i,f.a,k.a,C.d,C.a,C.f,C.h],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:64px;background:#eee;z-index:10}.btn-add[_ngcontent-%COMP%]{position:fixed;bottom:26px;right:30px}"]}),e})();var L=n("lJxs"),$=n("wd/R"),G=n("8hSh"),V=n("Gdn9"),H=n("Id7a");function R(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",21),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function U(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function Y(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",21),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function z(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function X(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function Q(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}let Z=(()=>{class e{constructor(e,t,n,o,a,r,i){this._toast=e,this._loader=t,this._stockService=n,this._productService=o,this._depositService=a,this._dialogRef=r,this.inputData=i,this.productSearchAutocompleteOptions={placeholder:"Produto",onGetItems:e=>this.productSearchAutocompleteOnGetItems(e),onSelectItem:e=>this.productSearchAutocompleteOnSelectItem(e),emitOnClear:!0},this.deposits=[],this.initForm()}ngOnInit(){this.getDeposits()}initForm(){this.depositTransferForm=new r.g({originDeposit:new r.e(null,r.s.required),destinationDeposit:new r.e(null,r.s.required),companyBranchProduct:new r.e(null,r.s.required),quantity:new r.e(null,[r.s.required,r.s.min(1)]),dateOfIssue:new r.e($().format("YYYY-MM-DDTHH:mm"),r.s.required),observation:new r.e(null)})}getDeposits(){this._loader.show(),this._depositService.getAll({companyBranchId:this.inputData.companyBranchId}).subscribe(e=>{this._loader.dismiss(),this.deposits=e},e=>{this._loader.dismiss(),this._toast.showHttpError(e)})}productSearchAutocompleteOnGetItems(e){return this._productService.getAllForSales({index:0,limit:8,q:e},this.inputData.companyBranchId).pipe(Object(L.a)(e=>e.map(e=>({label:`${e.product.code} - ${e.product.name}`,value:e}))))}productSearchAutocompleteOnSelectItem(e){var t;this.selectedProduct=e.value,this.depositTransferForm.get("companyBranchProduct").setValue((null===(t=e.value)||void 0===t?void 0:t.id)||null)}transfer(){if(!this.depositTransferForm.valid)throw this.depositTransferForm.markAllAsTouched(),this._toast.open("Preencha todos os campos obrigat\xf3rios"),new Error("Invalid form");const e={originDepositId:this.depositTransferForm.get("originDeposit").value,destinationDepositId:this.depositTransferForm.get("destinationDeposit").value,companyBranchProductId:this.depositTransferForm.get("companyBranchProduct").value,quantity:this.depositTransferForm.get("quantity").value,dateOfIssue:$(this.depositTransferForm.get("dateOfIssue").value).toISOString(),observation:this.depositTransferForm.get("observation").value};this._loader.show(),this._stockService.depositTransfer(e).subscribe(e=>{this._loader.dismiss(),this._toast.open("Transfer\xeancia conclu\xedda","success"),this._dialogRef.close()},e=>{this._loader.dismiss(),this._toast.showHttpError(e),this._dialogRef.close({hasUpdate:!0})})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](G.a),s["\u0275\u0275directiveInject"](V.a),s["\u0275\u0275directiveInject"](d.a),s["\u0275\u0275directiveInject"](i.g),s["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-deposit-transfer"]],decls:45,vars:8,consts:[[1,"row"],[1,"col-sm-12"],[1,"title"],[3,"formGroup"],[1,"col-md-6"],["formControlName","originDeposit"],["type",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","destinationDeposit"],[1,"col-12"],[3,"options"],["productAutocomplete",""],["matInput","","placeholder","Quantidade","type","number","autocomplete","off","formControlName","quantity"],["quantity",""],["matInput","","type","datetime-local","placeholder","Data","autocomplete","off","formControlName","dateOfIssue"],["dateOfIssue",""],[1,"col-md-12"],["matInput","","placeholder","Observa\xe7\xe3o","autocomplete","off","formControlName","observation"],["observation",""],["mat-flat-button","","color","primary",2,"margin","24px 0",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(s["\u0275\u0275element"](0,"button-dialog-close"),s["\u0275\u0275elementStart"](1,"div",0),s["\u0275\u0275elementStart"](2,"div",1),s["\u0275\u0275elementStart"](3,"h3",2),s["\u0275\u0275text"](4,"Transfer\xeancia de estoque"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"form",3),s["\u0275\u0275elementStart"](6,"div",0),s["\u0275\u0275elementStart"](7,"div",4),s["\u0275\u0275elementStart"](8,"mat-form-field"),s["\u0275\u0275elementStart"](9,"mat-label"),s["\u0275\u0275text"](10,"Dep\xf3sito origem"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"mat-select",5,6),s["\u0275\u0275template"](13,R,2,2,"mat-option",7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](14,U,2,0,"mat-error",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"div",4),s["\u0275\u0275elementStart"](16,"mat-form-field"),s["\u0275\u0275elementStart"](17,"mat-label"),s["\u0275\u0275text"](18,"Dep\xf3sito destino"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](19,"mat-select",9,6),s["\u0275\u0275template"](21,Y,2,2,"mat-option",7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](22,z,2,0,"mat-error",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](23,"div",10),s["\u0275\u0275element"](24,"app-autocomplete",11,12),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"div",4),s["\u0275\u0275elementStart"](27,"mat-form-field"),s["\u0275\u0275element"](28,"input",13,14),s["\u0275\u0275template"](30,X,2,0,"mat-error",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](31,"div",4),s["\u0275\u0275elementStart"](32,"mat-form-field"),s["\u0275\u0275element"](33,"input",15,16),s["\u0275\u0275template"](35,Q,2,0,"mat-error",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](36,"div",17),s["\u0275\u0275elementStart"](37,"mat-form-field"),s["\u0275\u0275element"](38,"input",18,19),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](40,"hr"),s["\u0275\u0275elementStart"](41,"div",0),s["\u0275\u0275elementStart"](42,"div",1),s["\u0275\u0275elementStart"](43,"button",20),s["\u0275\u0275listener"]("click",function(){return t.transfer()}),s["\u0275\u0275text"](44,"Transferir"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](29),n=s["\u0275\u0275reference"](34);s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("formGroup",t.depositTransferForm),s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngForOf",t.deposits),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.depositTransferForm.get("originDeposit").valid),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngForOf",t.deposits),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.depositTransferForm.get("destinationDeposit").valid),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("options",t.productSearchAutocompleteOptions),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngIf",!e.valid),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",!n.valid)}},directives:[v.a,r.t,r.n,r.h,p.c,p.f,h.a,r.m,r.f,o.l,o.m,H.a,u.b,r.q,r.d,f.a,g.k,p.b],styles:[""]}),e})();function J(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",20),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.label," ")}}function K(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function W(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}function ee(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"mat-error"),s["\u0275\u0275text"](1," Este campo \xe9 obrigat\xf3rio "),s["\u0275\u0275elementEnd"]())}let te=(()=>{class e{constructor(e,t,n,o,a,r){this._loader=e,this._toast=t,this._dialogRef=n,this._stockService=o,this._productService=a,this.inputData=r,this.productSearchAutocompleteOptions={placeholder:"Produto",onGetItems:e=>this.productSearchAutocompleteOnGetItems(e),onSelectItem:e=>this.productSearchAutocompleteOnSelectItem(e),emitOnClear:!0},this.postTypes={types:{in:"in",out:"out"},factor:{in:1,out:-1},list:[{id:"in",label:"Entrada"},{id:"out",label:"Sa\xedda"}]},this.initForm()}ngOnInit(){}initForm(){this.stockForm=new r.g({companyBranchProduct:new r.e(null,r.s.required),type:new r.e(this.postTypes.types.in,r.s.required),quantity:new r.e(null,[r.s.required,r.s.min(1)]),observation:new r.e(null),dateOfIssue:new r.e($().format("YYYY-MM-DDTHH:mm"),r.s.required)})}productSearchAutocompleteOnGetItems(e){return this._productService.getAllForSales({index:0,limit:8,q:e},this.inputData.companyBranchId).pipe(Object(L.a)(e=>e.map(e=>({label:`${e.product.code} - ${e.product.name}`,value:e}))))}productSearchAutocompleteOnSelectItem(e){var t;this.selectedProduct=e.value,this.stockForm.get("companyBranchProduct").setValue((null===(t=e.value)||void 0===t?void 0:t.id)||null)}save(){if(!this.stockForm.valid)throw this.stockForm.markAllAsTouched(),this._toast.open("Preencha todos os campos obrigat\xf3rios"),new Error("Invalid form");const e=this.postTypes.types[this.stockForm.get("type").value],t=Number(this.stockForm.get("quantity").value)*this.postTypes.factor[e],n={companyBranchProductId:this.selectedProduct.id,depositId:this.inputData.depositId,quantity:t,dateOfIssue:$(this.stockForm.get("dateOfIssue").value).toISOString(),observation:this.stockForm.get("observation").value};this._loader.show(),this._stockService.createPost(n).subscribe(e=>{this._loader.dismiss(),this._toast.open("Lan\xe7amento salvo!","success"),this._dialogRef.close({hasUpdate:!0})},e=>{this._loader.dismiss(),this._toast.showHttpError(e)})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](i.g),s["\u0275\u0275directiveInject"](G.a),s["\u0275\u0275directiveInject"](V.a),s["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stock-post-form"]],decls:37,vars:6,consts:[[1,"row"],[1,"col-sm-12"],[1,"title"],[3,"formGroup"],[1,"col-12"],[3,"options"],["productAutocomplete",""],[1,"col-md-4"],["formControlName","type"],["type",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","placeholder","Quantidade","type","number","autocomplete","off","formControlName","quantity"],["quantity",""],["matInput","","type","datetime-local","placeholder","Data","autocomplete","off","formControlName","dateOfIssue"],["dateOfIssue",""],[1,"col-md-12"],["matInput","","placeholder","Observa\xe7\xe3o","autocomplete","off","formControlName","observation"],["observation",""],["mat-flat-button","","color","primary",2,"margin","24px 0",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(s["\u0275\u0275element"](0,"button-dialog-close"),s["\u0275\u0275elementStart"](1,"div",0),s["\u0275\u0275elementStart"](2,"div",1),s["\u0275\u0275elementStart"](3,"h3",2),s["\u0275\u0275text"](4,"Novo lan\xe7amento"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"form",3),s["\u0275\u0275elementStart"](6,"div",0),s["\u0275\u0275elementStart"](7,"div",4),s["\u0275\u0275element"](8,"app-autocomplete",5,6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"div",7),s["\u0275\u0275elementStart"](11,"mat-form-field"),s["\u0275\u0275elementStart"](12,"mat-label"),s["\u0275\u0275text"](13,"Tipo"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"mat-select",8,9),s["\u0275\u0275template"](16,J,2,2,"mat-option",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](17,K,2,0,"mat-error",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"div",7),s["\u0275\u0275elementStart"](19,"mat-form-field"),s["\u0275\u0275element"](20,"input",12,13),s["\u0275\u0275template"](22,W,2,0,"mat-error",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](23,"div",7),s["\u0275\u0275elementStart"](24,"mat-form-field"),s["\u0275\u0275element"](25,"input",14,15),s["\u0275\u0275template"](27,ee,2,0,"mat-error",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"div",16),s["\u0275\u0275elementStart"](29,"mat-form-field"),s["\u0275\u0275element"](30,"input",17,18),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](32,"hr"),s["\u0275\u0275elementStart"](33,"div",0),s["\u0275\u0275elementStart"](34,"div",1),s["\u0275\u0275elementStart"](35,"button",19),s["\u0275\u0275listener"]("click",function(){return t.save()}),s["\u0275\u0275text"](36,"Salvar"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](21),n=s["\u0275\u0275reference"](26);s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("formGroup",t.stockForm),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("options",t.productSearchAutocompleteOptions),s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngForOf",t.postTypes.list),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.stockForm.get("type").valid),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",!e.valid),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",!n.valid)}},directives:[v.a,r.t,r.n,r.h,H.a,p.c,p.f,h.a,r.m,r.f,o.l,o.m,u.b,r.q,r.d,f.a,g.k,p.b],styles:[""]}),e})();var ne=n("iC8P"),oe=n("Qu3c"),ae=n("OJOy");function re(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",26),s["\u0275\u0275text"](1,"Produto"),s["\u0275\u0275elementEnd"]())}function ie(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",27),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate2"](" ",null==e.depositProduct?null:e.depositProduct.companyBranchProduct.product.name," (",null==e.depositProduct?null:e.depositProduct.companyBranchProduct.product.code,") ")}}function se(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",26),s["\u0275\u0275text"](1,"Tipo"),s["\u0275\u0275elementEnd"]())}function le(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",28),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275styleProp"]("color",e.quantity>0?"var(--color-nephritis)":"var(--color-peterriver)"),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.quantity>0?"Entrada":"Sa\xedda"," ")}}function ce(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",26),s["\u0275\u0275text"](1,"Quantidade"),s["\u0275\u0275elementEnd"]())}function de(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",28),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.quantity," ")}}function me(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",26),s["\u0275\u0275text"](1,"Observa\xe7\xe3o"),s["\u0275\u0275elementEnd"]())}function pe(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",29),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("matTooltip",e.observation),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.observation," ")}}function ue(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"th",26),s["\u0275\u0275text"](1,"Data"),s["\u0275\u0275elementEnd"]())}function he(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td",27),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"momentDate"),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind2"](2,1,e.dateOfIssue,"DD/MM/YYYY HH:mm")," ")}}function fe(e,t){1&e&&s["\u0275\u0275element"](0,"th",26)}function ve(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td",27),s["\u0275\u0275elementStart"](1,"a",30),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"]().deletePost(n)}),s["\u0275\u0275elementStart"](2,"mat-icon"),s["\u0275\u0275text"](3,"delete"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function ge(e,t){1&e&&s["\u0275\u0275element"](0,"tr",31)}function Se(e,t){1&e&&s["\u0275\u0275element"](0,"tr",32)}function ye(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",33),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().loadMore()}),s["\u0275\u0275text"](1,"Mais..."),s["\u0275\u0275elementEnd"]()}}function Ee(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate2"](" ",e.companyBranchProduct.product.name," (",e.companyBranchProduct.product.code,") "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.quantity)}}function be(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"table",34),s["\u0275\u0275elementStart"](1,"thead"),s["\u0275\u0275elementStart"](2,"tr"),s["\u0275\u0275elementStart"](3,"th"),s["\u0275\u0275text"](4,"Produto"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"th"),s["\u0275\u0275text"](6,"Quantidade"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"tbody"),s["\u0275\u0275template"](8,Ee,5,3,"tr",35),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngForOf",e.deposit.products)}}let Ie=(()=>{class e{constructor(e,t,n,o,a,r,i){this._toast=e,this._loader=t,this._stockService=n,this._dialog=o,this._alert=a,this._productService=r,this.inputData=i,this.stockPosts=[],this.tableColumns=["product","type","quantity","observation","createdAt","options"],this.productSearchAutocompleteOptions={placeholder:"Produto",onGetItems:e=>this.productSearchAutocompleteOnGetItems(e),onSelectItem:e=>this.productSearchAutocompleteOnSelectItem(e),emitOnClear:!0},this.filter={index:0,limit:40,depositId:i.depositId}}ngOnInit(){this.refresh()}refresh(){this._loader.show(),Promise.all([this.getDeposit(),this.getPosts()]).then(()=>this._loader.dismiss()).catch(()=>this._loader.dismiss())}getDeposit(e={}){return new Promise((t,n)=>{(null==e?void 0:e.showLoader)&&this._loader.show(),this._stockService.getDepositById(this.inputData.depositId).subscribe(n=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this.deposit=n,t()},t=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this._toast.showHttpError(t),n()})})}getPosts(e={}){return new Promise((t,n)=>{(null==e?void 0:e.showLoader)&&this._loader.show(),this._stockService.getPosts(this.filter).subscribe(n=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this.stockPosts=(null==e?void 0:e.concat)?this.stockPosts.concat(n):n,t()},t=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this._toast.showHttpError(t),n()})})}openPostForm(){this._dialog.open(te,{width:"50%",height:"80%",data:{companyBranchId:this.inputData.companyBranchId,depositId:this.deposit.id}}).afterClosed().subscribe(e=>{e&&e.hasUpdate&&this.refresh()})}productSearchAutocompleteOnGetItems(e){return this._productService.getAllForSales({index:0,limit:8,q:e},this.inputData.companyBranchId).pipe(Object(L.a)(e=>e.map(e=>({label:`${e.product.code} - ${e.product.name}`,value:e}))))}productSearchAutocompleteOnSelectItem(e){var t;this.selectedProduct=e.value,this.filter.companyBranchProductId=null===(t=this.selectedProduct)||void 0===t?void 0:t.id,this.filterProduct()}loadMore(){this.filter.index++,this.getPosts({concat:!0})}filterProduct(){this.filter.index=0,this.getPosts({showLoader:!0})}deletePost(e){this._alert.open({message:`Excluir lan\xe7amento #${e.id}? \u{1f615}`,title:"#"+e.id,buttons:[{text:"Cancelar",closeOnClick:!0},{text:"Excluir",color:"warn",onClick:()=>{this._loader.show(),this._stockService.deletePost(e.id).subscribe(e=>{this._loader.dismiss(),this._toast.open("Exclu\xeddo com sucesso","success"),this.refresh()},e=>{this._loader.dismiss(),this._toast.showHttpError(e)})}}]})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](G.a),s["\u0275\u0275directiveInject"](i.b),s["\u0275\u0275directiveInject"](ne.a),s["\u0275\u0275directiveInject"](V.a),s["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stock-posts"]],decls:39,vars:7,consts:[[2,"font-size","24px","margin","16px"],[1,"row"],[1,"col-md-8"],[2,"display","flex","gap","48px","align-items","center"],[2,"font-size","18px"],["mat-flat-button","","color","primary",2,"width","40%",3,"click"],[2,"width","100%",3,"options"],["productAutocomplete",""],["mat-table","",2,"width","100%",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["mat-cell","","style","font-weight: bold;",3,"color",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","style","font-weight: bold;",4,"matCellDef"],["matColumnDef","observation"],["mat-cell","",3,"matTooltip",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[2,"text-align","center","padding","10px"],["mat-flat-button","","color","primary",3,"click",4,"ngIf"],[1,"col-md-4"],["class","stock-table",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",2,"font-weight","bold"],["mat-cell","",3,"matTooltip"],["href","javascript:;",3,"click"],["mat-header-row",""],["mat-row",""],["mat-flat-button","","color","primary",3,"click"],[1,"stock-table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s["\u0275\u0275element"](0,"button-dialog-close"),s["\u0275\u0275elementStart"](1,"h1",0),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"div",1),s["\u0275\u0275elementStart"](4,"div",2),s["\u0275\u0275elementStart"](5,"div",3),s["\u0275\u0275elementStart"](6,"h2",4),s["\u0275\u0275text"](7,"Lan\xe7amentos"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"button",5),s["\u0275\u0275listener"]("click",function(){return t.openPostForm()}),s["\u0275\u0275text"](9,"Novo lan\xe7amento"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](10,"app-autocomplete",6,7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"table",8),s["\u0275\u0275elementContainerStart"](13,9),s["\u0275\u0275template"](14,re,2,0,"th",10),s["\u0275\u0275template"](15,ie,2,2,"td",11),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](16,12),s["\u0275\u0275template"](17,se,2,0,"th",10),s["\u0275\u0275template"](18,le,2,3,"td",13),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](19,14),s["\u0275\u0275template"](20,ce,2,0,"th",10),s["\u0275\u0275template"](21,de,2,1,"td",15),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](22,16),s["\u0275\u0275template"](23,me,2,0,"th",10),s["\u0275\u0275template"](24,pe,2,2,"td",17),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](25,18),s["\u0275\u0275template"](26,ue,2,0,"th",10),s["\u0275\u0275template"](27,he,3,4,"td",11),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275elementContainerStart"](28,19),s["\u0275\u0275template"](29,fe,1,0,"th",10),s["\u0275\u0275template"](30,ve,4,0,"td",11),s["\u0275\u0275elementContainerEnd"](),s["\u0275\u0275template"](31,ge,1,0,"tr",20),s["\u0275\u0275template"](32,Se,1,0,"tr",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](33,"div",22),s["\u0275\u0275template"](34,ye,2,0,"button",23),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](35,"div",24),s["\u0275\u0275elementStart"](36,"h2",4),s["\u0275\u0275text"](37,"Total"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](38,be,9,1,"table",25),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](null==t.deposit?null:t.deposit.name),s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("options",t.productSearchAutocompleteOptions),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("dataSource",t.stockPosts),s["\u0275\u0275advance"](19),s["\u0275\u0275property"]("matHeaderRowDef",t.tableColumns),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("matRowDefColumns",t.tableColumns),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.stockPosts.length>=t.filter.limit),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf",null==t.deposit?null:t.deposit.products.length))},directives:[v.a,f.a,H.a,C.j,C.c,C.e,C.b,C.g,C.i,o.m,C.d,C.a,oe.a,k.a,C.f,C.h,o.l],pipes:[ae.a],styles:[".stock-table[_ngcontent-%COMP%]{width:100%}.stock-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}.stock-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .stock-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{max-width:calc(100vw / 10);white-space:nowrap;word-wrap:break-word;overflow:hidden;text-overflow:ellipsis}.stock-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0 7px}"]}),e})();var we=n("Wp6s");function xe(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"mat-option",11),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate2"](" ",e.tradeName," - ",e.name," ")}}function _e(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",12),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().openDepositTransfer()}),s["\u0275\u0275text"](1," Transfer\xeancia de estoque "),s["\u0275\u0275elementStart"](2,"mat-icon"),s["\u0275\u0275text"](3,"swap_horiz"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function Ce(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate2"](" ",e.companyBranchProduct.product.name," (",e.companyBranchProduct.product.code,") "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.quantity)}}function ke(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"table",17),s["\u0275\u0275elementStart"](1,"thead"),s["\u0275\u0275elementStart"](2,"tr"),s["\u0275\u0275elementStart"](3,"th"),s["\u0275\u0275text"](4,"Produto"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"th"),s["\u0275\u0275text"](6,"Quantidade"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"tbody"),s["\u0275\u0275template"](8,Ce,5,3,"tr",18),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngForOf",e.products)}}function Pe(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",13),s["\u0275\u0275elementStart"](1,"mat-card"),s["\u0275\u0275elementStart"](2,"mat-card-header"),s["\u0275\u0275elementStart"](3,"mat-card-title",14),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"mat-card-content"),s["\u0275\u0275template"](6,ke,9,1,"table",15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"mat-card-actions"),s["\u0275\u0275elementStart"](8,"button",16),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"]().openStockPosts(n.id)}),s["\u0275\u0275text"](9,"Lan\xe7amentos"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](e.name),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",e.products.length)}}let Oe=(()=>{class e{constructor(e,t,n,o,a,r){this._title=e,this._toast=t,this._loader=n,this._stockService=o,this._companyBranchService=a,this._dialog=r,this.companyBranches=[],this.deposits=[]}ngOnInit(){this._title.set("Controle de estoque"),this.getCompanyBranches()}getStockDeposits(e={}){(null==e?void 0:e.showLoader)&&this._loader.show(),this._stockService.getDeposits(Number(this.companyBranchIdValue)).subscribe(t=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this.deposits=t,console.log(t)},t=>{(null==e?void 0:e.showLoader)&&this._loader.dismiss(),this._toast.showHttpError(t)})}getCompanyBranches(){this._companyBranchService.getAll().subscribe(e=>{this.companyBranches=e},e=>{this._toast.showHttpError(e)})}openStockPosts(e){const t={depositId:e,companyBranchId:Number(this.companyBranchIdValue)};this._dialog.open(Ie,{maxWidth:"90%",width:"90%",height:"90%",data:t}).afterClosed().subscribe(e=>{this.getStockDeposits()})}openDepositTransfer(){const e={companyBranchId:Number(this.companyBranchIdValue)};this._dialog.open(Z,{width:"50%",height:"80%",data:e}).afterClosed().subscribe(e=>{this.getStockDeposits()})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](_.a),s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](G.a),s["\u0275\u0275directiveInject"](m.a),s["\u0275\u0275directiveInject"](i.b))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stock-control"]],decls:16,vars:5,consts:[[2,"font-size","32px","margin","16px"],[1,"row"],[1,"col-md-12"],[2,"display","flex","gap","48px","align-items","center"],[2,"width","50%"],[3,"ngModel","ngModelChange","selectionChange"],["companyBranch",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",3,"disabled","click"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["class","col-md-4",4,"ngFor","ngForOf"],[3,"value"],["mat-stroked-button","","color","primary",3,"click"],[1,"col-md-4"],[2,"font-weight","bold"],["class","stock-table",4,"ngIf"],["mat-button","",3,"click"],[1,"stock-table"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"h1",0),s["\u0275\u0275text"](1,"Controle de estoque"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](2,"div",1),s["\u0275\u0275elementStart"](3,"div",2),s["\u0275\u0275elementStart"](4,"div",3),s["\u0275\u0275elementStart"](5,"mat-form-field",4),s["\u0275\u0275elementStart"](6,"mat-label"),s["\u0275\u0275text"](7,"Unidade"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"mat-select",5,6),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.companyBranchIdValue=e})("selectionChange",function(){return t.getStockDeposits({showLoader:!0})}),s["\u0275\u0275template"](10,xe,2,3,"mat-option",7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"button",8),s["\u0275\u0275listener"]("click",function(){return t.getStockDeposits({showLoader:!0})}),s["\u0275\u0275text"](12,"Atualizar"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](13,_e,4,0,"button",9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"div",1),s["\u0275\u0275template"](15,Pe,10,2,"div",10),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](9);s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngModel",t.companyBranchIdValue),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.companyBranches),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("disabled",!e.value),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",e.value),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.deposits)}},directives:[p.c,p.f,h.a,r.m,r.p,o.l,f.a,o.m,g.k,k.a,we.a,we.d,we.g,we.c,we.b],styles:[".stock-table[_ngcontent-%COMP%]{width:100%}.stock-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}.stock-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .stock-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:6px}"]}),e})();const De=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stock"]],decls:1,vars:0,template:function(e,t){1&e&&s["\u0275\u0275element"](0,"router-outlet")},directives:[a.h],styles:[""]}),e})(),children:[{path:"deposits",component:N},{path:"stock-control",component:Oe}]}];let Fe=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.g.forChild(De)],a.g]}),e})();var je=n("ssao"),Be=n("PCNd"),Ae=n("iTUp");let Me=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.c,je.a,Fe,Be.a,r.r,r.i,Ae.a]]}),e})()}}]);